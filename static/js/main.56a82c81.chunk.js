(this.webpackJsonptest02=this.webpackJsonptest02||[]).push([[0],{412:function(e,t,n){},413:function(e,t,n){},479:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(18),s=n.n(i),o=(n(412),n(259)),l=n.n(o),u=n(390),d=n(367),g=n(368),f=n(391),b=n(389),h=n(369),j=n(370),p=n(23),O=(n(413),n(253)),y=n.n(O),v=n(515),x=n(516),m=n(517),k=n(519),w=n(374),C=n.n(w),S=n(384),q=n.n(S),R=n(375),T=n.n(R),P=n(382),D=n.n(P),N=n(261),Q=n.n(N),F=n(260),W=n.n(F),_=n(376),I=n.n(_),B=n(377),U=n.n(B),$=n(379),A=n.n($),E=n(380),J=n.n(E),L=n(381),H=n.n(L),V=n(385),G=n.n(V),M=n(378),Y=n.n(M),z=n(383),X=n.n(z),K=n(386),Z=n.n(K),ee=n(348),te=n(345),ne=n(256),ae=n(334),re=n(255),ce=n(258),ie=n(349),se=n(19),oe={widgets:[{type:"text",id:"txt1",value:"<h1>My Test Website</h1>"},{type:"text",id:"txt2",value:"<h2>Publications</h2>"},{type:"table",id:"t1",label:"",dataref:"q1",colspecs:[{title:"Year",field:"year",cellStyle:{cellWidth:"10%"}},{title:"Venue",field:"venue",cellStyle:{cellWidth:"20%"}},{title:"Title",field:"title",cellStyle:{cellWidth:"50%"}},{title:"Authors",field:"authors",cellStyle:{cellWidth:"20%"}},{title:"pdf",field:"pdf",render:function(e){return Object(se.jsx)("a",{href:"https://lipyeow.github.io/home/"+e.pdf,download:!0,children:"pdf"})}}],options:{search:!0,paging:!1,filtering:!1,exportButton:!0,maxBodyHeight:"50vh",tableLayout:"auto"}},{type:"query",id:"q1",backend:"urlfetch",endpoint:"r0",query:"https://lipyeow.github.io/test02/data/pubs.json",fetch_on_init:!0,args:[]},{type:"query",id:"q2",backend:"constant",endpoint:"r0",query:{cols:[{title:"Year",field:"year"},{title:"Title",field:"title"},{title:"Venue",field:"venue"}],data:[{year:"2020",title:"Deep learning",authors:"john et al",venue:"vldb"},{year:"2021",title:'<a href="https://lipyeow.github.io/home/">pdf</a>',authors:"Tim et al",venue:"sigmod"}]},args:[{from:"ti1"},{from:"ti1"},{from:"m1"},{from:"m1"}]}]},le={Add:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(C.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Check:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(T.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Clear:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(W.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Delete:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(I.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),DetailPanel:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(Q.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Edit:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(U.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Export:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(Y.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Filter:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(A.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),FirstPage:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(J.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),LastPage:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(H.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),NextPage:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(Q.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),PreviousPage:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(D.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),ResetSearch:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(W.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),Search:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(X.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),SortArrow:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(q.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),ThirdStateCheck:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(G.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))})),ViewColumn:Object(r.forwardRef)((function(e,t){return Object(se.jsx)(Z.a,Object(p.a)(Object(p.a)({},e),{},{ref:t}))}))},ue=new v.a({uri:"http://127.0.0.1:4000/graphql",cache:new x.a,fetchOptions:{mode:"no-cors"}}),de=Object(m.a)(a||(a=Object(j.a)(["\n  query GetData($endpoint: String!, $query: String!, $args: String) {\n    getData(endpoint: $endpoint, query: $query, args: $args) {\n      data\n      colstr\n      columns {\n        title\n        field\n      }\n    }\n  }\n"])));function ge(e){return console.log(e.state[e.id]),Object(se.jsx)("div",{style:{maxWidth:"100%"},children:Object(se.jsx)(y.a,{icons:le,title:e.label,data:e.state[e.state[e.id].dataref].data,columns:e.state[e.id].colspecs.length>0?e.state[e.id].colspecs:e.state[e.state[e.id].dataref].cols,options:e.state[e.id].options})})}var fe=Object(ee.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"25ch"}},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function be(e){var t=fe();return Object(se.jsx)("form",{className:t.root,noValidate:!0,autoComplete:"off",children:e.widgets.map((function(n){return he(n,e.callbacks,e.state,t)}))})}function he(e,t,n,a){switch(e.type){case"form":return Object(se.jsx)(be,{callbacks:t,state:n,widgets:e.widgets},e.id);case"table":return Object(se.jsx)(ge,{id:e.id,label:e.label,state:n,updateData:t.updateData},e.id);case"text_input":return Object(se.jsx)(te.a,{state:n,id:"queryinput",label:e.label,onChange:function(n){return t.handleTextChange(e.id,n)},variant:"outlined"},e.id);case"menu":return Object(se.jsxs)(re.a,{state:n,variant:"filled",className:a.formControl,children:[Object(se.jsx)(ne.a,{id:"demo-simple-select-filled-label",children:e.label}),Object(se.jsxs)(ce.a,{labelId:"demo-simple-select-filled-label",id:"qtypedropdown",value:n[e.id].value,onChange:function(n){return t.handleSelectChange(e.id,n)},children:[Object(se.jsx)(ae.a,{value:"",children:Object(se.jsx)("em",{children:"None"})}),e.values.map((function(e){return Object(se.jsx)(ae.a,{value:e.value,children:e.display},e.id)}))]})]},e.id);case"button":return Object(se.jsx)(ie.a,{state:n,id:e.id,trigger:e.trigger,variant:"contained",onClick:function(){return t.handleClick(e.id)},children:e.label},e.id);case"text":return Object(se.jsx)("div",{dangerouslySetInnerHTML:{__html:e.value}},e.id);default:return null}}function je(e,t){switch(t.type){case"table":e[t.id]={dataref:t.dataref,cols:[],colspecs:t.colspecs,options:t.options};break;case"query":e[t.id]={data:[],cols:[],backend:t.backend,endpoint:t.endpoint,query:t.query,args:t.args},"constant"===t.backend&&(e[t.id].data=t.query.data,e[t.id].cols=t.query.cols);break;case"text_input":case"menu":e[t.id]={value:""};break;case"button":e[t.id]={value:"",trigger:t.trigger};break;case"text":e[t.id]={value:t.value};break;case"form":pe(e,t.widgets)}return e}function pe(e,t){return t.reduce(je,e)}function Oe(e){return new Promise((function(t){return setTimeout(t,e)}))}function ye(e,t){for(var n={},a=0;a<e.length;a++)n[e[a]]=t[a];return n}function ve(){return(ve=Object(h.a)(l.a.mark((function e(t,n){var a,r,c,i,s,o,u,d,g,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="http://localhost:5000/presto/v1/statement",(r=new Headers).append("Content-Type","text/plain"),r.append("Access-Control-Allow-Origin","*"),r.append("X-Presto-User","l002"),c={method:"POST",headers:r,body:t},console.log(a),console.log(c),i={},e.prev=9,e.next=12,fetch(a,c);case 12:return e.next=14,e.sent.json();case 14:i=e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),console.log(e.t0);case 20:console.log(i),s={method:"GET",headers:r},o=i.nextUri.replace(":8080/",":5000/presto/"),console.log(o),console.log(s),u=i.stats.state,d=0;case 27:if(!(d<8)){e.next=48;break}return e.next=30,Oe(4e3);case 30:return e.prev=30,e.next=33,fetch(o,s);case 33:return e.next=35,e.sent.json();case 35:i=e.sent,e.next=41;break;case 38:e.prev=38,e.t1=e.catch(30),console.log(e.t1);case 41:if(u=i.stats.state,console.log(i),"FINISHING"!==u){e.next=45;break}return e.abrupt("break",48);case 45:d++,e.next=27;break;case 48:return g=i.columns.map((function(e){return e.name})),(f={}).data=i.data.map((function(e){return ye(g,e)})),f.cols=g.map((function(e){return{title:e,field:e}})),n(f.data,f.cols),e.abrupt("return",f);case 54:case"end":return e.stop()}}),e,null,[[9,17],[30,38]])})))).apply(this,arguments)}var xe=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).spec=oe,a.staging=pe({},oe.widgets),a.spec.widgets.map((function(e){return"query"===e.type&&"urlfetch"===e.backend&&e.fetch_on_init&&a.runUrlFetchQuery(e.id),null})),a.state=a.staging,console.log(a.state),a}return Object(g.a)(n,[{key:"handleTextChange",value:function(e,t){console.log("handleTextChange("+e+"): "),console.log(this.state),this.staging[e].value=t.target.value}},{key:"handleSelectChange",value:function(e,t){console.log("handleSelectChange("+e+"): "),console.log(this.state),this.staging[e].value=t.target.value,this.setState(this.staging)}},{key:"runPrestoQuery",value:function(e){var t=this;console.log("Run Presto Query: "+e),function(e,t){ve.apply(this,arguments)}(this.staging[e].query,(function(n,a){t.staging[e].data=n,t.staging[e].cols=a,console.log(t.staging),t.setState(t.staging)}))}},{key:"runNativeQuery",value:function(e){var t,n=this,a=[],r=Object(u.a)(this.staging[e].args);try{for(r.s();!(t=r.n()).done;){var c=t.value;a.push(this.staging[c.from].value)}}catch(s){r.e(s)}finally{r.f()}var i={endpoint:this.staging[e].endpoint,query:this.staging[e].query,args:JSON.stringify(a)};ue.query({query:de,variables:i}).then((function(t){console.log(t),console.log("Before setting data: staging = "),console.log(n.staging),console.log("qid = "+e),n.staging[e].data=JSON.parse(t.data.getData.data),n.staging[e].cols=JSON.parse(t.data.getData.colstr),console.log("Before setState: staging = "),console.log(n.staging),n.setState(n.staging)}))}},{key:"runConstantQuery",value:function(e){console.log("Run Constant Query: "+e),this.staging[e].data=this.staging[e].query.data,this.staging[e].cols=this.staging[e].query.cols,console.log(this.staging),this.setState(this.staging)}},{key:"runUrlFetchQuery",value:function(e){var t=this;console.log("Run Url Fetch Query: "+e);var n=this.staging[e].query;fetch(n).then((function(e){return e.json()})).then((function(n){console.log(n),t.staging[e].data=n,t.staging[e].cols=function(e){return Object.keys(e[0]).map((function(e){return{title:e,field:e}}))}(n),t.setState(t.staging)}))}},{key:"handleClick",value:function(e){console.log("handleClick("+e+"): ");var t=this.staging[e].trigger;switch(this.staging[t].backend){case"presto":this.runPrestoQuery(t);break;case"native":this.runNativeQuery(t);break;case"constant":this.runConstantQuery(t);break;default:console.log("Unrecognized backend: "+this.staging[t].backend)}}},{key:"generateWidget",value:function(e){var t=this;return he(e,{handleClick:function(e){return t.handleClick(e)},handleTextChange:function(e,n){return t.handleTextChange(e,n)},handleSelectChange:function(e,n){return t.handleSelectChange(e,n)},updateData:function(e,n,a){return t.updateData(e,n,a)}},this.state,null)}},{key:"render",value:function(){var e=this;return Object(se.jsx)("div",{style:{maxWidth:"100%"},children:Object(se.jsx)(k.a,{client:ue,children:this.spec.widgets.map((function(t){return e.generateWidget(t)}))})})}}]),n}(r.Component),me=function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,909)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};s.a.render(Object(se.jsx)(c.a.StrictMode,{children:Object(se.jsx)(xe,{})}),document.getElementById("root")),me()}},[[479,1,2]]]);
//# sourceMappingURL=main.56a82c81.chunk.js.map